{"version":3,"sources":["App.tsx","Utils.tsx","index.tsx"],"names":["default_template","App","useState","wasm","setWasm","hasHeaders","setHasHeaders","inputContent","setInputContent","template","setTemplate","output","setOutput","useEffect","param","URL","window","location","href","searchParams","has","console","log","decoded","decompressFromEncodedURIComponent","get","then","module","err","error","message","className","data-tooltip","rows","value","onChange","event","target","length","compressed","compressToEncodedURIComponent","new_uri","pathname","split","pop","history","replaceState","name","type","accept","e","files","reader","FileReader","readAsArrayBuffer","onload","buf","result","rendered","render","Uint8Array","html","loadFile","id","checked","htmlFor","ReactHtmlParser","readOnly","title","disabled","onClick","text","navigator","clipboard","writeText","blob","Blob","link","document","createElement","createObjectURL","download","click","remove","downloadAsHtml","ReactDOM","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.a2edfe0b.chunk.js","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport ReactHtmlParser from 'react-html-parser';\nimport { compressToEncodedURIComponent, decompressFromEncodedURIComponent } from 'lz-string';\nimport './App.css';\nimport { toClipboard, downloadAsHtml } from './Utils';\n\ntype ModuleType = typeof import('tablify');\nlet default_template = `<style>\ntr:nth-child(odd) {\n    background: #f7f7ff;\n}\n</style>\n<table>\n{%- if headers %}\n<thead>\n    <tr>\n        {%- for e in headers %}\n        <th>{{e}}</th>\n        {%- endfor %}\n    </tr>\n</thead>\n{%- endif %}\n<tbody>\n    {%- for row in rows %}\n    <tr>\n        {%- for e in row %}\n        <td>{{e}}</td>\n        {%- endfor %}\n    </tr>\n    {%- endfor %}\n</tbody>\n</table>`;\n\nfunction App() {\n  const [wasm, setWasm] = useState<ModuleType | null>(null);\n  const [hasHeaders, setHasHeaders] = useState(false);\n  const [inputContent, setInputContent] = useState(\"\");\n  const [template, setTemplate] = useState(default_template);\n  const [output, setOutput] = useState(\"\");\n  useEffect(() => {\n    const param = new URL(window.location.href).searchParams;\n    if (param.has(\"t\")) {\n      console.log(\"Set template from the URL\")\n      const decoded = decompressFromEncodedURIComponent(param.get(\"t\") as string);\n      if (decoded !== null) {\n        default_template = decoded;\n        setTemplate(default_template);\n      }\n    }\n  }, [])\n  useEffect(() => {\n    try {\n      import('tablify').then((module: ModuleType) => {\n        setWasm(module);\n        console.log('wasm has been loaded successfully.')\n      });\n    } catch (err) {\n      console.error(`Unexpected error in loading wasm. [Message: ${err.message}]`);\n    }\n  }, [])\n  function loadFile(files: FileList) {\n    console.log(files);\n    if (files.length > 0) {\n      const reader = new FileReader();\n      reader.readAsArrayBuffer(files[0]);\n      reader.onload = function () {\n        if (wasm !== null) {\n          const buf = reader.result as ArrayBuffer;\n          try {\n            const table_template = \"<table>{%- if headers %}<thead><tr>{%- for e in headers %}<th>{{e}}</th>{%- endfor %}</tr></thead>{%- endif %}<tbody>{%- for row in rows %}<tr>{%- for e in row %}<td>{{e}}</td>{%- endfor %}</tr>{%- endfor %}</tbody></table>\";\n            const rendered = wasm.render(table_template, new Uint8Array(buf), files[0].name, hasHeaders, false);\n            setInputContent(rendered);\n            const html = wasm.render(template, new Uint8Array(buf), files[0].name, hasHeaders, false);\n            setOutput(html);\n          } catch (error) {\n            console.error(error);\n            setInputContent('<p class=\"error\">' + error + '</p>');\n            setOutput(\"\")\n          }\n        }\n      }\n    }\n  }\n\n  function onTemplateChange(event: React.ChangeEvent<HTMLTextAreaElement>) {\n    setTemplate(event.target.value);\n    if (event.target.value.length > 0) {\n      const compressed = compressToEncodedURIComponent(event.target.value);\n      const new_uri = (window.location.pathname.split('/').pop() + '?t=' + compressed);\n      window.history.replaceState({}, '', new_uri);\n    } else {\n      window.history.replaceState({}, '', window.location.pathname);\n    }\n  }\n\n  return (\n    <div className=\"App\">\n      <header>\n        <h1>Tablify</h1>\n      </header>\n      <div>\n        <h2>Template <span className=\"info tooltip\" data-tooltip=\"Set Jinja2/Django template\"></span></h2>\n        <textarea className=\"code\" rows={5} value={template} onChange={onTemplateChange} name=\"template\"></textarea >\n        <h2>Tabular data <span className=\"info tooltip\" data-tooltip=\"Choose tabular file (.csv or .xlsx)\"></span></h2>\n        <input type=\"file\" accept=\".xlsx,.csv\" onChange={(e: any) => loadFile(e.target.files)}></input>\n        <input type=\"checkbox\" id=\"hasHeaders\" onChange={(e: any) => setHasHeaders(e.target.checked)} checked={hasHeaders}></input>\n        <label htmlFor=\"hasHeaders\">data has headers</label>\n      </div>\n      <div>\n        <h2>Input contents</h2>\n        {ReactHtmlParser(inputContent)}\n      </div>\n      <div>\n        <h2>Output</h2>\n        <textarea className=\"code\" rows={5} id=\"output\" value={output} readOnly></textarea>\n        <button title=\"Copy output to the clipboard\"\n          disabled={output === ''}\n          onClick={(event) => toClipboard(output)}>Copy</button>\n        <button title=\"Save output as a file\"\n          disabled={output === ''}\n          onClick={(event) => downloadAsHtml(output, \"table.html\")}>Save</button>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","/**\n * Save text as a text file.\n */\n export function downloadAsHtml(text: string, name: string) {\n  const blob = new Blob([text], { type: 'text/html' });\n  var link = document.createElement('a');\n  link.href = URL.createObjectURL(blob);\n  link.download = name;\n  link.click();\n  link.remove();\n}\n\n/**\n * Copy text to clipboard\n */\nexport function toClipboard(text: string) {\n  if (navigator.clipboard) {\n    navigator.clipboard.writeText(text);\n  }\n}","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}